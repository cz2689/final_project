<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Project Report</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Descriptive_Info.html">Descriptive Info</a>
</li>
<li>
  <a href="Statistical_Analysis.html">Statistical Analysis</a>
</li>
<li>
  <a href="Dashboard.html">Dashboard</a>
</li>
<li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="data_source.html">Data Source</a>
</li>
<li>
  <a href="references.html">References</a>
</li>
<li>
  <a href="https://github.com/cz2689/final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Project Report</h1>

</div>


<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>There are around 48 million people in US using marijuana, and it
could lead to various health impacts. As more and more states legalize
marijuana, marijuana use has been causing significant social impacts and
attracting a vast amount of public attention. The legality of marijuana
use remains controversial in the US. Each state has their own
restrictions on their marijuana laws for both medical and recreational
purposes. Based on data from the “World Population Review,” by July
2022, 14 states have fully legalized the use of marijuana. In this
project, we will evaluate the association among marijuana use and
depression, and we would like to propose recommendations for future
studies and policies. <br></p>
</div>
<div id="research-question" class="section level2">
<h2>Research Question</h2>
<p>In this project, we aim to:</p>
<ul>
<li>understand the association between marijuana use and mental health
burdens, using 2019 NSDUH</li>
<li>stratify or adjust for wide a range of demographic and
sociodemographic variables</li>
<li>provide suggestions on marijuana legalization for future substance
prevention programs and policymakers</li>
</ul>
</div>
<div id="data-process-and-cleaning" class="section level2">
<h2>Data Process AND Cleaning</h2>
<div id="nsduh" class="section level3">
<h3><strong>NSDUH</strong></h3>
<p>To study the association between marijuana use and mental health, we
used data from the 2019 National Survey on Drug Use and Health (<a
href="https://nsduhweb.rti.org/respweb/homepage.cfm">NSDUH</a>). This
nationwide study is sponsored by the Center for Behavioral Health
Statistics and Quality within the Substance Abuse and Mental Services
Administration (SAMHSA) and is performed annually. It collects
up-to-date information on tobacco, alcohol, drug use, mental health and
other health-related issues in the general population in the US. Every
year, NSDUH interviews approximately 70,000 people aged 12 and older.
<br></p>
<p>We picked the 2019 NSDUH, since it is the newest published version
besides the 2020 data. Due to the COVID-19 pandemic, SAMHSA suspended
in-person data collection on the 2020 NSDUH on March 16, 2020. For the
purpose of data collection, a small-scale in-person data collection was
conducted in selected counties of two states from July 16 to July 22,
2020, with approval. Also, on September 11, 2020, SAMHSA approved a
web-based survey. As NSDUH claimed, in-person and web-based data
collections yielded differences in response and non-response patterns.
Consequently, we highly question the representativity of the 2020 data.
<strong>We believe the 2019 data can give us a more accurate and
comprehensive idea about the prevalence and association between
marijuana use and mental health.</strong> <br></p>
<p>For the process of data cleaning, first, we defined our marijuana
users as people who used marijuana in the past 30 days, since the
duration, frequency, and dose of marijuana use are highly related to
mental health. Then, we selected the variables that we wound to focused
in this project:</p>
<ul>
<li><code>age2</code>: age categories</li>
<li><code>mrjmon</code>: past month marijuana use</li>
<li><code>mjrec</code>: time-since-last-aarijuana-sse</li>
<li><code>mr30est</code>: marijuana frequency last month</li>
<li><code>coutyp4</code>: county metro/nonmetro status</li>
<li><code>catag6</code>: six-level age category</li>
<li><code>irmjage</code>: marijuana age of first use</li>
<li><code>amdeyr</code>: past year major depressive episode for
adult</li>
<li><code>ymdeyr</code>: past year major depressive episode for
youth</li>
<li><code>irsex</code>: gender</li>
<li><code>newrace2</code>: race category</li>
<li><code>eduhighcat</code>: education level</li>
<li><code>income</code>: income level</li>
<li><code>irmarit</code>: marital status</li>
</ul>
<p>Finally, we filtered out all the missing values. More detailed data
manipulation for each visualization graphs can be found in the
<strong>EDA</strong> section. <br></p>
</div>
<div id="mapping" class="section level3">
<h3><strong>Mapping</strong></h3>
<p>To create map and show legalization situation for marijuana use in
the United States, we find out the up-to-data data in <a
href="https://mjbizdaily.com/">MJBizDaily</a>. MJBizDaily is a website
to report Marijuana Business Daily, so we believe data from this website
are latest and convincing. In the dataset, it included varibales listed
below:</p>
<ul>
<li><code>State</code>: States’ name in the United States</li>
<li><code>Recreational</code>: whether States are legal for marijuana
recreational use</li>
<li><code>Year_legalized_REC</code>: Legalization year for marijuana
recreational use</li>
<li><code>Medical</code>: whether States are legal for marijuana medical
use</li>
<li><code>Year_legalized_MED</code>: Legalization year for marijuana
recreational use</li>
</ul>
<p><br></p>
</div>
</div>
<div id="eda" class="section level2">
<h2>EDA</h2>
<p>In this section, we utilize visualizing tools to explore the
marijuana use patterns across age groups and depression prevalence
patterns in the United States. <br></p>
<div id="age-and-time-since-last-marijuana-use" class="section level3">
<h3>Age and Time-Since-Last-Marijuana-Use</h3>
<p>In 2019 NSDUH, investigators collected information about
time-since-last-marijuana-use. The question in the survey was:
“<strong>how long has it been since you last used marijuana or
hashish?</strong>” According to the code book, answers to this question
are: “within the past 30 days (13.62%),”more than 30 days ago but within
the last 12 months (7.47%)“,”more than 12 months ago (22.3%)“,”used in
the past 30 days - logically assigned (0.01%), “used in the past 12
months - logically assigned (0.36%),”used at some point in the lifetime
- logically assigned (0.39%), “never used marijuana (55.78%)”, “refused
(0.03%)”, and “blank” (0.04%)“.</p>
<p>Additionally, we also want to use the age information which was
recoded as <code>age2</code> in the 2019 NSDHU data set. Researchers
coded participants’ age into 17 categories, including:</p>
<ul>
<li>1 = Respondent is 12 years old</li>
<li>2 = Respondent is 13 years old</li>
<li>3 = Respondent is 14 years old</li>
<li>4 = Respondent is 15 years old</li>
<li>5 = Respondent is 16 years old</li>
<li>6 = Respondent is 17 years old</li>
<li>7 = Respondent is 18 years old</li>
<li>8 = Respondent is 19 years old</li>
<li>9 = Respondent is 20 years old</li>
<li>10 = Respondent is 21 years old</li>
<li>11 = Respondent is 22-23 years old</li>
<li>12 = Respondent is 24-25 years old</li>
<li>13 = Respondent is 26-29 years old</li>
<li>14 = Respondent is 30-34 years old</li>
<li>15 = Respondent is 35-49 years old</li>
<li>16 = Respondent is 50-64 years old</li>
<li>17 = Respondent is 65+ years old</li>
</ul>
<p>In our exploratory step, we excluded people who answered “never used
marijuana” since they are not the group we are interested in. Then, we
also dropped the logically assigned answers and people who answered
“refused” and “blank” to avoid misclassification. Although this can
reduce our statistical power, dropped values only count for less than 1%
(0.83%) of the entire sample group. We assume dropping them will not
affect the data presentation. Finally, we constructed two plots to
explore the relationship between age and time-since-last-marijuana-use
groups.</p>
<div id="age-distributions-in-time-since-last-marijuana-use-groups"
class="section level4">
<h4><em>1. Age Distributions in Time-Since-Last-Marijuana-Use
groups</em></h4>
<pre class="r"><code>mari_df %&gt;% 
  ggplot(aes(x = age2, y = mjrec, fill = factor(stat(quantile)))) + 
  stat_density_ridges(geom = &quot;density_ridges_gradient&quot;, calc_ecdf = TRUE, quantiles = 5, alpha = 0.5) +
  scale_fill_viridis_d(name = &quot;Quintiles&quot;) + 
  theme_ridges() +
  labs(x = &quot;Age Categories&quot;,
       y = &quot;Time-since-last-Marijuana-use&quot;,
       caption = &quot;In Age categories: 1 = 12-yrs-old; 2 = 13-yrs-old; 3 = 14-yrs-old; 4 = 15-yrs-old; 5 = 16-yrs-old; 6 = 17-yrs-old; 7 = 18-yrs-old; 8 = 19-yrs-old; 9 = 20-yrs-old; \n10 = 21-yrs-old; 11 = 22-23 yrs-old; 12 = 24-25 yrs-old; 13 = 26-29 yrs-old; 14 = 30-34 yrs-old; 15 = 35-49 yrs-old; 16 = 50-64 yrs-old; 17 = &gt;=65-yrs-old&quot;) +
  scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17))+
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-3-1.png" width="1344" /></p>
<p>Comparing the age distributions among time-since-last-marijuana-use
groups, only the curve for “12+ months” group has one obvious peak
located at “age = 15” (35-49 yrs-old). Curves for other two groups look
more like tri-modal distribution which has more than one peak.</p>
<p>If we compare quantiles among the 3 groups, the “12+ months” group
has a very different age distribution. Younger than 34-year-olds
contributed to the first two quintiles, while older than 50-year-olds
contributed to the last quintile. However, the first two quintiles of
the “0-1 month” and “1-12 months” groups were occupied by people younger
than 23, and the last quintile by people older than 35. As a result,
there are relatively more younger people in the “0-1 month” and “1-12
months” groups.</p>
<p>Additionally, the first 20% of people in the “0-1 month” group are
people younger than 19, and the first 20% of people in the “1-12 months”
group are people younger than 18 years old. This difference is
relatively small, and these two groups have very similar age
distribution based on quintiles.</p>
</div>
<div id="time-since-last-marijuana-use-comparision-among-age-groups"
class="section level4">
<h4><em>2. Time-Since-Last-Marijuana-Use comparision Among Age
Groups</em></h4>
<pre class="r"><code>mari_df %&gt;% 
  ggplot(aes(x = age2, fill = mjrec)) +
  geom_histogram(position = &quot;dodge&quot;) +
  labs(x = &quot;Age Categories&quot;,
       y = &quot;Time-since-last-Marijuana-use&quot;,
       caption = &quot;In Age categories: 1 = 12-yrs-old; 2 = 13-yrs-old; 3 = 14-yrs-old; 4 = 15-yrs-old; 5 = 16-yrs-old; 6 = 17-yrs-old; 7 = 18-yrs-old; 8 = 19-yrs-old; 9 = 20-yrs-old; \n10 = 21-yrs-old; 11 = 22-23 yrs-old; 12 = 24-25 yrs-old; 13 = 26-29 yrs-old; 14 = 30-34 yrs-old; 15 = 35-49 yrs-old; 16 = 50-64 yrs-old; 17 = &gt;=65-yrs-old&quot;) +
  scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17))+
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-4-1.png" width="1344" /></p>
<p>According to the histogram plot, in the 13-year-old, 14-year-old,
16-year-old, 17-year-old, 18-year-old, 19-year-old, 20-year-old,
21-year-old, 22-to-23-year-old groups, the time-since-last-marijuana-use
for people are most likely be “0-1 month”. However, for people older
than 24, the time-since-last-marijuana-use are more likely to be “12+
months”. Consequently, as people get older, they tend to use marijuana
less often.</p>
<p><br></p>
</div>
</div>
<div id="marijuana-use-in-the-past-30-days" class="section level3">
<h3>Marijuana Use In The Past 30 Days</h3>
<p>In 2019 NSDUH, investigators collected information about #DAYS USED
MARIJUANA PAST 30 DAYS. In this part, we excluded individuals who
answered “ Don’t Know” “Refused” “Blank” “Legitimate Skip” to this
question, which accounted for 14.32% of the total survey. The answers to
this question were originally recorded as categories, including “1-2
days” “3-5 days” “6-9 days” “10-19 days” “20-29 days” “all 30 days”. In
order to convert the variable to a continuous variable, we randomly
assigned a number of days from its days range.</p>
<p>First, let’s explore the marijuana use pattern in the past 30 days of
the survey in different age groups.</p>
<pre class="r"><code>  graph_fendi %&gt;% 
    group_by(age_cat) %&gt;% 
    summarise(days = sum(days30)) %&gt;% 
    knitr::kable(digits = 0)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">age_cat</th>
<th align="right">days</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">12 - 15</td>
<td align="right">102</td>
</tr>
<tr class="even">
<td align="left">16 - 19</td>
<td align="right">473</td>
</tr>
<tr class="odd">
<td align="left">20 - 25</td>
<td align="right">279</td>
</tr>
<tr class="even">
<td align="left">26 - 29</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="left">30 - 34</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">35 - 49</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="left">50 - 64</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">older_than_65</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>This table shows the cumulative numbers of days used marijuana in
past 30 days in each age range. There were 56136 individuals
participating the 2019 NSDUH survey. We can see that people who aged
between 16 and 19 years accumulated the most number of days of marijuana
using in the past 30 days of the survey, followed by those who aged
between 20 and 25 years.</p>
<div id="number-of-days-used-marijuana-in-past-30-days"
class="section level4">
<h4><em>1. Number of Days Used Marijuana in Past 30 Days</em></h4>
<pre class="r"><code>graph_fendi %&gt;%
    filter(days30 != 0) %&gt;% 
    ggplot(aes(x = age_cat, y = days30)) +
    geom_boxplot(aes(fill = age_cat), alpha = .5) +
  labs(x = &quot;Age(years)&quot;, y = &quot;Number of Days&quot;) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>This graph shows the distribution of the numbers of days used
marijuana in past 30 days of each individual. Those aged between 16 and
25 years had the widest range, while people who aged between 26 and 29
years had the highest mean for number of days used marijuana in past 30
days.</p>
</div>
<div
id="percentage-of-individuals-used-marijuana-in-past-30-days-by-metro-area"
class="section level4">
<h4><em>2. Percentage of Individuals Used Marijuana in Past 30 Days By
Metro Area</em></h4>
<p>Now, let’s take a look at the marijuana use pattern in the past 30
days of the survey in different types of metro areas.</p>
<pre class="r"><code>graph_fendi %&gt;% 
  mutate(coutyp4 = as.character(coutyp4),
    coutyp4 = recode(coutyp4, 
                     &quot;1&quot; = &quot;Large Metro&quot;, &quot;2&quot; = &quot;Small Metro&quot;, &quot;3&quot; = &quot;Nonmetro&quot;),
    coutyp4 = fct_relevel(coutyp4, &quot;Large Metro&quot;, &quot;Small Metro&quot;, &quot;Nonmetro&quot;)) %&gt;% 
  group_by(coutyp4) %&gt;% 
    summarise( used30_percent = round(sum(use30)/n()*100, 2)) %&gt;% 
    ggplot(aes(x = coutyp4, y = used30_percent)) +
    geom_bar(stat = &quot;identity&quot;, width = 0.5, fill = &quot;steelblue&quot;) +
  geom_text(aes(label = used30_percent), vjust = 1.6, color = &quot;white&quot;, size = 3.5) +
  labs(x = &quot;Metro Area&quot;, y = &quot;Percentage(%)&quot;) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We can see that the marijuana use patterns in the past 30 days did
not vary much across different metro areas. Slightly more individuals
from the “large Metro” area (0.17%) used marijuana in the past 30 days
of the survey than the other two types of metro areas.</p>
<p><br></p>
</div>
</div>
<div id="age-when-people-first-started-using-marijuana"
class="section level3">
<h3>Age When People First Started Using Marijuana</h3>
<pre class="r"><code>info_scatterplot = info_scatter %&gt;%
  filter(irmjage != 991) %&gt;%
  group_by(irmjage) %&gt;%
  summarise(number_people = n()) %&gt;%
  ggplot(aes(x = irmjage, y = number_people)) +
  geom_point() +
  geom_smooth() +
  labs(x = &quot;Age of first used marijuana&quot;, y = &quot;Frequency(number of people)&quot;,
       title = &quot;Age When First Used among people who used MARIJUANA/HASHISH&quot;) +
  theme_minimal()
  

info_scatterplot   </code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>In this part, we created a scatter plot to show the age when first
used MARIJUANA/HASHISH and frequency of people in each year. We excluded
people who never use MARIJUANA/HASHISH in this plot. Because, without
doubts, most people never use MARIJUANA/HASHISH. In our dataset, there
are 31340 people who never use MARIJUANA/HASHISH. Therefore, after
excluding people who never use MARIJUANA/HASHISH, it is more clear to
see the distribution of Age when First Used among people who used
MARIJUANA/HASHISH.</p>
<p>From this plot, we could conclude that most people who used Marijuana
started between 10 and 30 years old when first used marijuana. So, it is
necessary to focus on youth population during our further steps.</p>
<p><br></p>
</div>
<div id="depression-prevalence-pattern" class="section level3">
<h3>Depression Prevalence Pattern</h3>
<p>Now, we have finished exploring the marijuana use pattern in the
United States. In this last part, we would like to show the prevalence
of depression in the United States and how the prevalence varies across
different geographic areas among youths and adults. The association
between marijuana use and depression is explored under the tab <a
href="Statistical_Analysis.html">Statistical Analysis</a>.</p>
<p>Looking at the graph below,we can see that depression is more
prevalent among adults than youth across all three metro areas.
Regardless of the age group, depression is more prevalent in the
non-metro and the small-metro area than the large-metro area.</p>
<pre class="r"><code>graph_fendi %&gt;% 
  mutate(coutyp4 = as.character(coutyp4),
    coutyp4 = recode(coutyp4, 
                     &quot;1&quot; = &quot;Large Metro&quot;, &quot;2&quot; = &quot;Small Metro&quot;, &quot;3&quot; = &quot;Nonmetro&quot;),
    coutyp4 = fct_relevel(coutyp4, &quot;Large Metro&quot;, &quot;Small Metro&quot;, &quot;Nonmetro&quot;)) %&gt;% 
  group_by(coutyp4) %&gt;% 
    summarise( youth = round(sum(youth_dpr, na.rm=TRUE)/n()*100, 2),
               adult = round(sum(adult_dpr, na.rm=TRUE)/n()*100, 2)) %&gt;% 
  pivot_longer(
    youth:adult,
    names_to = &quot;age_group&quot;,
    values_to = &quot;dpr_percent&quot;
  ) %&gt;% 
  ggplot(aes(x = coutyp4, y = dpr_percent, fill = age_group)) +
    geom_bar(stat = &quot;identity&quot;, width = 0.5, position = &quot;dodge&quot;) + 
    labs(title = &quot;Percentage of Individuals Having Depression By Metro Area&quot;,
         x = &quot;Metro Area&quot;, y = &quot;Percentage(%)&quot;) +
    theme(plot.title = element_text(hjust = 0.5)) +
    theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="mapping-1" class="section level2">
<h2>Mapping</h2>
<p>In mapping section, we have three subtopics: where marijuana is legal
in the United States, how many states legalized for marijuana use, when
marijuana legaled in each State. Our goal is to visualized the marijuana
legalization data clearly, which could give our audience a clear
concept. At the same time, it is a supporting evidence in our
research.</p>
<p><br></p>
<div id="where-marijuana-is-legal-in-the-united-states"
class="section level3">
<h3>Where marijuana is legal in the United States?</h3>
<p>During this subtopic, we joined marijuana legalization data and
United States datasets to created a map using <code>usmap</code>
package. We would like to focus on the legalization status for marijuana
use in this part, so we created a map to visualized the result. In this
map, different colors filled represent different legalization status in
each state. Grey means those states are illegal for marijuana use; Blue
means those states are only legal for marijuana medical use; Red means
those states are legal for marijuana medicial use and recreational
use.</p>
<p><br></p>
</div>
<div id="how-many-states-legalized-for-marijuana-use"
class="section level3">
<h3>How many states legalized for marijuana use?</h3>
<pre class="r"><code>legalized_states &lt;- 
  legal_state%&gt;% 
  select(-Recreational, -Medical) %&gt;% 
  mutate(status = fct_relevel(status, &quot;Recreational/Medical&quot;, &quot;Medical&quot;, &quot;None&quot;)) %&gt;%
  group_by(status) %&gt;%
  summarise(state_number = n()) %&gt;%
  knitr::kable(col.names = c(&quot;State&quot;, &quot;number of states&quot;))

legalized_states</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">State</th>
<th align="right">number of states</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Recreational/Medical</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">Medical</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left">Illegal</td>
<td align="right">11</td>
</tr>
</tbody>
</table>
<p>We created a summarized table to show the number of states for each
legalization status. From the previous map and this summarized table
(‘legalized_states’), there are 22 states that are legal to use
marijuana for both recreational and medical. There are 18 states where
are only legal to use marijuana for medical. Only 11 states are fully
illegal to use marijuana. If you would like to see which specific states
are fully illegal, you could check our map or data in our <a
href="Dashboard.html">Dashboard</a>.</p>
<p><br></p>
</div>
<div id="when-marijuana-legaled-in-each-state" class="section level3">
<h3>When marijuana legaled in each State?</h3>
<pre class="r"><code>year_df = mapping_df %&gt;%
  select(full,Year_legalized_REC,Year_legalized_MED) %&gt;%
  pivot_longer(
    Year_legalized_REC:Year_legalized_MED,
    names_to = &quot;rec_med&quot;, 
    values_to = &quot;year&quot;)


legal_year &lt;- year_df %&gt;%
  plot_ly(x = ~ year, y = ~full, color = ~rec_med, type = &quot;scatter&quot;, mode = &quot;markers&quot;) %&gt;%
  layout(title = &quot;Legalized year of each state&quot;, 
         yaxis = list(title = &quot;States&quot;, tickfont = list(size = 5)), xaxis = list(title = &quot;Legalized year&quot;)) #add title in the graph

legal_year</code></pre>
<div id="htmlwidget-70436215473c8d1a7710" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-70436215473c8d1a7710">{"x":{"visdat":{"474caca3ef1":["function () ","plotlyVisDat"]},"cur_data":"474caca3ef1","attrs":{"474caca3ef1":{"x":{},"y":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Legalized year of each state","yaxis":{"domain":[0,1],"automargin":true,"title":"States","tickfont":{"size":5},"type":"category","categoryorder":"array","categoryarray":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Illinois","Iowa","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Dakota","Utah","Vermont","Virginia","Washington","West Virginia"]},"xaxis":{"domain":[0,1],"automargin":true,"title":"Legalized year"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2021,1998,2010,2016,1996,2000,2012,2011,2011,2016,2015,2000,2013,2017,2015,1999,2013,2012,2008,2014,2022,2018,2004,1998,2013,2010,2007,2014,2016,2016,2018,1998,2016,2006,2020,2018,2004,2020,1998,2017],"y":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Illinois","Iowa","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Dakota","Utah","Vermont","Virginia","Washington","West Virginia"],"mode":"markers","type":"scatter","name":"Year_legalized_MED","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2014,2020,2016,2012,2021,2015,2019,2016,2022,2016,2018,2022,2020,2016,2020,2021,2021,2014,2022,2020,2021,2012],"y":["Alaska","Arizona","California","Colorado","Connecticut","District of Columbia","Illinois","Maine","Maryland","Massachusetts","Michigan","Missouri","Montana","Nevada","New Jersey","New Mexico","New York","Oregon","Rhode Island","Vermont","Virginia","Washington"],"mode":"markers","type":"scatter","name":"Year_legalized_REC","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>We created a scatter plot showed legalization year for each state.
From this plot, we could see that, before 2002, most of states are fully
illegal and a few states are only legal for medicial use. However, after
2022, it is obviously that marijuana use is gaining legalized.</p>
<p>Although people could use marijuana legally, most states are only
legal for medical use and the legalization year of recreational use must
be later than medical use, which is reasonable. Thus, if we have
avaiable dataset, a potential meaningful research is to do the time
trend of depression cases to test whether distributions of legalization
time and depression cases number are consistent.</p>
<p><br></p>
</div>
</div>
<div id="statistical-analysis" class="section level2">
<h2>Statistical Analysis</h2>
<p>In this section, we try to obtain the prevalence of depression across
a wide range of sociodemographic characteristics for both youths and
adults. And then we try to perform logistic regression to obtain the
odds of depression comparing those who used marijuana in the past month
to those who do not while adjusting for other covariates.</p>
<div id="depression-by-sociodemographic-characteristcs"
class="section level3">
<h3>Depression by sociodemographic characteristcs</h3>
<div id="youths-12---17-years-old" class="section level4">
<h4>Youths (12 - 17 years old)</h4>
<ol style="list-style-type: decimal">
<li>Youth depression by age category:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(catag6, ymdeyr) %&gt;% 
  drop_na(ymdeyr) %&gt;% 
  mutate(ymdeyr = ifelse(ymdeyr == 2, 0, 1),
         catag6 = recode(catag6, &quot;1&quot; = &quot;12-17 years old&quot;,
                         &quot;2&quot; = &quot;18-25 years old&quot;,
                         &quot;3&quot; = &quot;26-34 years old&quot;,
                         &quot;4&quot; = &quot;35-49 years old&quot;,
                         &quot;5&quot; = &quot;50-64 years old&quot;,
                         &quot;6&quot; = &quot;65+ years old&quot;
                         )) %&gt;% 
  group_by(catag6) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(ymdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">catag6</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">12-17 years old</td>
<td align="right">16.2</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for youth is
16.2%.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Youth depression by gender:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(irsex, ymdeyr) %&gt;% 
  drop_na(ymdeyr) %&gt;% 
  mutate(ymdeyr = ifelse(ymdeyr == 2, 0, 1),
         irsex = recode(irsex, &quot;1&quot; = &quot;Male&quot;,
                         &quot;2&quot; = &quot;Female&quot;)) %&gt;% 
  group_by(irsex) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(ymdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">irsex</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Female</td>
<td align="right">23.62</td>
</tr>
<tr class="even">
<td align="left">Male</td>
<td align="right">9.18</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for youth is
highest among female.</li>
<li>Female youth depression is more than twofold of male youth
depression.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Youth depression by race:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(newrace2, ymdeyr) %&gt;% 
  drop_na(ymdeyr) %&gt;% 
  mutate(ymdeyr = ifelse(ymdeyr == 2, 0, 1),
         newrace2 = recode(newrace2, &quot;1&quot; = &quot;NonHisp White&quot;,
                         &quot;2&quot; = &quot;NonHisp Black&quot;,
                         &quot;3&quot; = &quot;NonHisp Native Am&quot;,
                         &quot;4&quot; = &quot;NonHisp Native HI&quot;,
                         &quot;5&quot; = &quot;NonHisp Asian&quot;,
                         &quot;6&quot; = &quot;NonHisp more than one race&quot;,
                         &quot;7&quot; = &quot;Hispanic&quot;
                         )) %&gt;% 
  group_by(newrace2) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(ymdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">newrace2</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Hispanic</td>
<td align="right">17.65</td>
</tr>
<tr class="even">
<td align="left">NonHisp Asian</td>
<td align="right">13.91</td>
</tr>
<tr class="odd">
<td align="left">NonHisp Black</td>
<td align="right">11.61</td>
</tr>
<tr class="even">
<td align="left">NonHisp more than one race</td>
<td align="right">20.61</td>
</tr>
<tr class="odd">
<td align="left">NonHisp Native Am</td>
<td align="right">17.09</td>
</tr>
<tr class="even">
<td align="left">NonHisp Native HI</td>
<td align="right">13.33</td>
</tr>
<tr class="odd">
<td align="left">NonHisp White</td>
<td align="right">16.42</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for youth is
highest among those who identified them to have more than one race.</li>
<li>The lowest is among Non-Hispanic Black.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Youth depression by family income:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(income, ymdeyr) %&gt;% 
  drop_na(ymdeyr) %&gt;% 
  mutate(ymdeyr = ifelse(ymdeyr == 2, 0, 1),
         income = recode(income, &quot;1&quot; = &quot;Less than $20,000&quot;,
                         &quot;2&quot; = &quot;$20,000 - $49,999&quot;,
                         &quot;3&quot; = &quot;$50,000 - $74,999&quot;,
                         &quot;4&quot; = &quot;$75,000 or More&quot;
                         )) %&gt;% 
  group_by(income) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(ymdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">income</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">$20,000 - $49,999</td>
<td align="right">16.03</td>
</tr>
<tr class="even">
<td align="left">$50,000 - $74,999</td>
<td align="right">19.37</td>
</tr>
<tr class="odd">
<td align="left">$75,000 or More</td>
<td align="right">15.36</td>
</tr>
<tr class="even">
<td align="left">Less than $20,000</td>
<td align="right">15.68</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for youth is
highest among those with total family income range $50,000 -
$74,999.</li>
</ul>
</div>
<div id="adults-18-years-old" class="section level4">
<h4>Adults (18 + years old)</h4>
<ol style="list-style-type: decimal">
<li>Adult depression by age categories:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(catag6, amdeyr) %&gt;% 
  drop_na(amdeyr) %&gt;% 
  mutate(amdeyr = ifelse(amdeyr == 2, 0, 1),
         catag6 = recode(catag6, &quot;1&quot; = &quot;12-17 years old&quot;,
                         &quot;2&quot; = &quot;18-25 years old&quot;,
                         &quot;3&quot; = &quot;26-34 years old&quot;,
                         &quot;4&quot; = &quot;35-49 years old&quot;,
                         &quot;5&quot; = &quot;50-64 years old&quot;,
                         &quot;6&quot; = &quot;65+ years old&quot;
                         )) %&gt;% 
  group_by(catag6) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(amdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">catag6</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">18-25 years old</td>
<td align="right">15.47</td>
</tr>
<tr class="even">
<td align="left">26-34 years old</td>
<td align="right">10.99</td>
</tr>
<tr class="odd">
<td align="left">35-49 years old</td>
<td align="right">8.51</td>
</tr>
<tr class="even">
<td align="left">50-64 years old</td>
<td align="right">6.21</td>
</tr>
<tr class="odd">
<td align="left">65+ years old</td>
<td align="right">3.43</td>
</tr>
</tbody>
</table>
<ul>
<li>The highest prevalence of past year major depressive episode for
adult is among those aged 18 - 25 years old.<br />
</li>
<li>And the prevalence decreases with age.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Adult depression by gender:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(irsex, amdeyr) %&gt;% 
  drop_na(amdeyr) %&gt;% 
  mutate(amdeyr = ifelse(amdeyr == 2, 0, 1),
         irsex = recode(irsex, &quot;1&quot; = &quot;Male&quot;,
                         &quot;2&quot; = &quot;Female&quot;)) %&gt;% 
  group_by(irsex) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(amdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">irsex</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Female</td>
<td align="right">12.99</td>
</tr>
<tr class="even">
<td align="left">Male</td>
<td align="right">7.84</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for adult is
also highest among female. However, the difference is not as large as
that of the youth.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Adult depression by race:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(newrace2, amdeyr) %&gt;% 
  drop_na(amdeyr) %&gt;% 
  mutate(amdeyr = ifelse(amdeyr == 2, 0, 1),
         newrace2 = recode(newrace2, &quot;1&quot; = &quot;NonHisp White&quot;,
                         &quot;2&quot; = &quot;NonHisp Black&quot;,
                         &quot;3&quot; = &quot;NonHisp Native Am&quot;,
                         &quot;4&quot; = &quot;NonHisp Native HI&quot;,
                         &quot;5&quot; = &quot;NonHisp Asian&quot;,
                         &quot;6&quot; = &quot;NonHisp more than one race&quot;,
                         &quot;7&quot; = &quot;Hispanic&quot;
                         )) %&gt;% 
  group_by(newrace2) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(amdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">newrace2</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Hispanic</td>
<td align="right">8.99</td>
</tr>
<tr class="even">
<td align="left">NonHisp Asian</td>
<td align="right">6.79</td>
</tr>
<tr class="odd">
<td align="left">NonHisp Black</td>
<td align="right">7.71</td>
</tr>
<tr class="even">
<td align="left">NonHisp more than one race</td>
<td align="right">16.20</td>
</tr>
<tr class="odd">
<td align="left">NonHisp Native Am</td>
<td align="right">11.99</td>
</tr>
<tr class="even">
<td align="left">NonHisp Native HI</td>
<td align="right">5.86</td>
</tr>
<tr class="odd">
<td align="left">NonHisp White</td>
<td align="right">11.70</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for adult is
highest among those who identified them to have more than one race.</li>
<li>The lowest is among Non-Hispanic Native Hawiian.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Adult depression by education: (We are not considering youth
education in this case.)</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(eduhighcat, amdeyr) %&gt;% 
  drop_na(amdeyr) %&gt;% 
  mutate(amdeyr = ifelse(amdeyr == 2, 0, 1),
         eduhighcat = recode(eduhighcat, &quot;1&quot; = &quot;Less high school&quot;,
                         &quot;2&quot; = &quot;High school grad&quot;,
                         &quot;3&quot; = &quot;Some coll/Assoc&quot;,
                         &quot;4&quot; = &quot;College graduate&quot;
                         )) %&gt;% 
  group_by(eduhighcat) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(amdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">eduhighcat</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">College graduate</td>
<td align="right">8.85</td>
</tr>
<tr class="even">
<td align="left">High school grad</td>
<td align="right">10.28</td>
</tr>
<tr class="odd">
<td align="left">Less high school</td>
<td align="right">7.82</td>
</tr>
<tr class="even">
<td align="left">Some coll/Assoc</td>
<td align="right">13.23</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for adult is
highest among those with some college degrees.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Adult depression by family income:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(income, amdeyr) %&gt;% 
  drop_na(amdeyr) %&gt;% 
  mutate(amdeyr = ifelse(amdeyr == 2, 0, 1),
         income = recode(income, &quot;1&quot; = &quot;Less than $20,000&quot;,
                         &quot;2&quot; = &quot;$20,000 - $49,999&quot;,
                         &quot;3&quot; = &quot;$50,000 - $74,999&quot;,
                         &quot;4&quot; = &quot;$75,000 or More&quot;
                         )) %&gt;% 
  group_by(income) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(amdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">income</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">$20,000 - $49,999</td>
<td align="right">11.39</td>
</tr>
<tr class="even">
<td align="left">$50,000 - $74,999</td>
<td align="right">10.55</td>
</tr>
<tr class="odd">
<td align="left">$75,000 or More</td>
<td align="right">8.12</td>
</tr>
<tr class="even">
<td align="left">Less than $20,000</td>
<td align="right">14.13</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for adult is
highest among those with total family income range less than
$20,000.</li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li>Adult depression by marital status:</li>
</ol>
<pre class="r"><code>data %&gt;% 
  select(irmarit, amdeyr) %&gt;% 
  drop_na(amdeyr) %&gt;% 
  mutate(amdeyr = ifelse(amdeyr == 2, 0, 1),
         irmarit = recode(irmarit, &quot;1&quot; = &quot;Married&quot;,
                         &quot;2&quot; = &quot;Widowed&quot;,
                         &quot;3&quot; = &quot;Divorced or Separated&quot;,
                         &quot;4&quot; = &quot;Never Been Married&quot;
                         )) %&gt;% 
  group_by(irmarit) %&gt;% 
  summarise(
    prevalence_of_past_year_depression = sum(amdeyr, na.rm = TRUE) / n() * 100) %&gt;% 
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">irmarit</th>
<th align="right">prevalence_of_past_year_depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Divorced or Separated</td>
<td align="right">12.19</td>
</tr>
<tr class="even">
<td align="left">Married</td>
<td align="right">6.51</td>
</tr>
<tr class="odd">
<td align="left">Never Been Married</td>
<td align="right">13.93</td>
</tr>
<tr class="even">
<td align="left">Widowed</td>
<td align="right">7.67</td>
</tr>
</tbody>
</table>
<ul>
<li>The prevalence of past year major depressive episode for adult is
highest among who have never been married.</li>
<li>And is lowest among those who is married.</li>
</ul>
</div>
</div>
<div id="logistic-regression-and-hypothesis-testing"
class="section level3">
<h3>Logistic regression and Hypothesis testing</h3>
<div id="youths-12---17-years-old-1" class="section level4">
<h4>Youths (12 - 17 years old)</h4>
<ol style="list-style-type: decimal">
<li>We perform a logistic regression on our outcome and exposure on
youths while adjusting for other covariates.<br />
ymdeyr (youth depression) = mrjmon (Past month marijuana Use) + catag6
(age) + irsex (sex) + newrace2 (race) + coutyp4 (region)<br />
And the resulting odds ratio is shown below:</li>
</ol>
<pre class="r"><code>reg %&gt;% 
  glm(ymdeyr ~ mrjmon + catag6 + irsex + newrace2 + coutyp4, data = ., family = binomial()) %&gt;% 
  broom::tidy() %&gt;% 
  mutate(OR = exp(estimate),
         conf.low = exp((estimate - 1.96 * std.error)),
         conf.high = exp((estimate + 1.96 * std.error))
         ) %&gt;%
  filter(term == &quot;mrjmon1&quot;) %&gt;% 
  select(term, OR, conf.low, conf.high) %&gt;% 
  knitr::kable(digits = 3)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">OR</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mrjmon1</td>
<td align="right">2.673</td>
<td align="right">2.309</td>
<td align="right">3.093</td>
</tr>
</tbody>
</table>
<ul>
<li>The odds of depression is 2.673 (95% CI: 2.309 - 3.093) comparing
youth who used cannabis in the past month to those who do not adjusting
for age, sex, race, region.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Is the beta for our exposure variable truly different from
zero?<br />
We obtained the p.value from the t.test statistics.</li>
</ol>
<pre class="r"><code>reg %&gt;% 
  glm(ymdeyr ~ mrjmon + catag6 + irsex + newrace2 + coutyp4, data = ., family = binomial()) %&gt;% 
  broom::tidy() %&gt;% 
  filter(term == &quot;mrjmon1&quot;) %&gt;% 
  select(term, statistic, p.value) %&gt;% 
  knitr::kable(digits = 4)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mrjmon1</td>
<td align="right">13.1759</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<ul>
<li>As we can see that the t-tests statistic for the term
<code>mrjmon1</code> which is marijuana past month use comparing Yes to
No is very large and the resulting p.value is close to zero. Our beta
coefficient of the exposure variable is significant.</li>
</ul>
</div>
<div id="adults-18-years-old-1" class="section level4">
<h4>Adults (18 + years old)</h4>
<ol style="list-style-type: decimal">
<li>We perform a logistic regression on our outcome and exposure on
adults while adjusting for other covariates.<br />
amdeyr (adult depression) = mrjmon (Past month marijuana Use) + catag6
(age) + irsex (sex) + newrace2 (race) + eduhighcat (education) + coutyp4
(region) + income (income) + irmarit (martial status)<br />
And the resulting odds ratio is shown below:</li>
</ol>
<pre class="r"><code>reg %&gt;% 
  glm(amdeyr ~ mrjmon + catag6 + irsex + newrace2 + eduhighcat + coutyp4 + income + irmarit, data = ., family = binomial()) %&gt;% 
  broom::tidy() %&gt;% 
  mutate(OR = exp(estimate),
         conf.low = exp((estimate - 1.96 * std.error)),
         conf.high = exp((estimate + 1.96 * std.error))
         ) %&gt;%
  filter(term == &quot;mrjmon1&quot;) %&gt;% 
  select(term, OR, conf.low, conf.high) %&gt;% 
  knitr::kable(digits = 3)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">OR</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mrjmon1</td>
<td align="right">1.935</td>
<td align="right">1.795</td>
<td align="right">2.086</td>
</tr>
</tbody>
</table>
<ul>
<li>The odds of depression is 1.935 (95% CI: 1.795 - 2.086) comparing
adults who used cannabis in the past month to those who do not adjusting
for age, sex, race, education, region, income, and martial status.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Is the beta for our exposure variable truly different from
zero?<br />
We obtained the p.value from the t.test statistics.</li>
</ol>
<pre class="r"><code>reg %&gt;% 
  glm(amdeyr ~ mrjmon + catag6 + irsex + newrace2 + eduhighcat + coutyp4 + income + irmarit, data = ., family = binomial()) %&gt;% 
  broom::tidy() %&gt;% 
  filter(term == &quot;mrjmon1&quot;) %&gt;% 
  select(term, statistic, p.value) %&gt;% 
  knitr::kable(digits = 4)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mrjmon1</td>
<td align="right">17.2173</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<ul>
<li>As we can see that the t-tests statistic for the term
<code>mrjmon1</code> which is marijuana past month use comparing Yes to
No is very large and the resulting p.value is close to zero. Our beta
coefficient of the exposure variable is significant.</li>
</ul>
</div>
</div>
</div>
<div id="finding-summary" class="section level2">
<h2>Finding &amp; Summary</h2>
<ul>
<li>Depression was distributed unevenly across a wide range of
sociodemographic variables.</li>
<li>The prevalence of youth depression was higher among female. It is
also true for adults.</li>
<li>Depression seems to be decreasing with age. The highest prevalence
is among those who is youngest.<br />
</li>
<li>Depression is more prevalent for adults with family income less than
$20,000 annually and who have never been married.</li>
<li>People who identified them to have more than one race have the
highest prevalence of depression among all the race categories for both
youth and adults.<br />
</li>
<li>Depression was significantly more common among those who reported
marijuana use in the past month for both youths and adults, adjusting
for demographic factors.</li>
<li>The odds of depression is 2.673 (95% CI: 2.309 - 3.093) comparing
youth who used cannabis in the past month to those who do not adjusting
for age, sex, race, region.</li>
<li>The odds of depression is 1.935 (95% CI: 1.795 - 2.086) comparing
adults who used cannabis in the past month to those who do not adjusting
for age, sex, race, education, region, income, and martial status.</li>
</ul>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>Based on the 2019 NSDUH, we observed that the prevalence of
depression was distributed unevenly across different sociodemographic
groups. High-risk groups for depression were identified in our study as
females, people with a family annual income less than $20,000, people
who are single, and people who self-identified to have more than one
race. Additionally, there is a statistically significant association
between marijuana use and depression. Comparing to youth who did not use
cannabis in the past month, the odds of depression are 167.3% higher in
youth who used cannabis in the past month. Although the magnitude of the
odds ratio is smaller in the adult group, the odds of depression are
still 93.5% higher comparing adults who used cannabis in the past month
to those who did not. Consequently, from a public health policy point of
view, we should not encourage the legalization of marijuana for
recreational use. Although the FDA has approved Epidiolex, a purified
form of CBD, for seizure treatment, more regulation should be added to
recreational marijuana. Finally, we also want to point out the main
limitation of our study we only used the 2019 data. Future studies
should include data from multiple years to understand the overall trend.
Also, after the COVID-19 pandemic, the prevalence of both marijuana use
and depression will also yield a lot of differences. More studies are
required on this controversial topic.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
